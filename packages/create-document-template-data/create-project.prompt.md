# Create template project instructions

## DO NOT WRITE OR EDIT ABOVE THIS LINE

## Create an index.ts file

The file needs to:
- create a new table with 4 columns: id, category, text, date_created. The new table should be a single table named `document_templates_{timestamp}` that will store all processed data from various source tables. `{timestamp}` should be replaced with the current timestamp in the format `YYYYMMDDHHMMSS` (e.g., `document_templates_20231001123000`). Create the table with raw SQL for expediency. The columns should be defined as follows:
  - ID: autoincrementing or guid - i don't care which
  - Category: the category is constructed from the table name, and the table primary key or id

    Answer: Here is the category mapping I would like, (items in brackets are column names):

    |TableName|Category|
    |---|---|
    |contributor_issues_prs|contributor_issues_prs:{org/repo}:{username}:{type}:{id}|
    |contributors|{id}|
    |repositories|{nameWithOwner}:{id}|
    |workflows|{orgRepo}:{id}:{path}|

  - Text: the text is created from the ./src/json-to-md.ts file. the `text` column should be generated by calling the `jsonToMarkdown` function (named export) from `./src/json-to-md.ts`. The function signature is expected to take a JSON object as input and return a Markdown string. The exact input/output format will depend on the structure of the JSON data.
  - date_created: the date created is the current date in ISO format.
- create a function that processes each table in the database and creates a new row in the table with the above columns. Log any tables or rows skipped due to errors with the error information. The function should create a DataSourceOptions object. 
- export the function so it can be used in other files.
- use the @dfb/db package in ./packages/db to do the database work. Let me know what functionality is missing from that package but is needed. The package doesn't have a way to enumerate all tables but it does have a way to fetch all rows from a specific table. The table names themselves are known as entities in the db package's src/entity directory. It would be beneficial to add a utility function to list all entities (tables) in the database. Use raw sql to query for all tables and all rows. Use the readme of the package to determine how to create the dataSourceOptions object to connect to the db. 
- scaffold a test function so I can try out the end to end flow. Add a utility to get all entities (tables) in the database. This utility should return an array of table names. The test should create a new table and print a summary. 

## Standards and practices

- Use TypeScript for type safety.
- Follow the DRY (Don't Repeat Yourself) principle.
- Use meaningful variable and function names.
- Ensure the code is well-documented with comments explaining the purpose of each function and significant code block.
- Use consistent coding style and formatting.

## Your expertise
- You are an expert in TypeScript and Node.js.
- You have experience with database operations and can effectively use the @dfb/db package.
- Ask questions instead of making assumptions. Ask questions until the context you need is complete. 
- Use actively listening to understand the requirements fully.


## questions

Should the utility to list all entities (tables) be placed in this package or do you want it added to @dfb/db for reuse? place it in this package. 
Should the test function actually insert data into the new table, or just simulate the process and print what would be inserted? simulate the process and print what would be inserted.
Is it acceptable to use synchronous console.log for logging, or do you prefer a logger? console.log for now
Should the script skip rows if the category mapping cannot be constructed (e.g., missing fields), or throw an error? skip rows and log an error.